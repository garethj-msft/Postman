{
  "variables": [],
  "info": {
    "name": "EduFacadeCoreTests",
    "_postman_id": "d5079a3b-a9ad-7368-c568-947a6c926c08",
    "description": "Core suite of integration tests for Rostering API on Microsoft Graph. Expected to pass 100% on 3 iterations.",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "_postman_id": "a9fe72cf-81c4-e41d-3943-954f947dce7c",
      "name": "Read",
      "description": "",
      "item": [
        {
          "_postman_id": "73d30c08-5927-c903-8bb4-e5ea9e9fc30b",
          "name": "T_RefreshToken GraphReadBasic",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Successful Request\"] = responseCode.code === 200;",
                  "if(responseCode.code === 200)",
                  "{",
                  "    var data = JSON.parse(responseBody);",
                  "    postman.setEnvironmentVariable(\"GraphAuth\", \"Bearer \" + data.access_token);",
                  "    postman.setEnvironmentVariable(\"GraphRefresh\", data.refresh_token);",
                  "    tests[\"New tokens written to environment\"] = true;",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "https://{{loginHost}}/common/oauth2/token",
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "grant_type",
                  "value": "refresh_token",
                  "type": "text"
                },
                {
                  "key": "refresh_token",
                  "value": "{{GraphRefreshReadBasic}}",
                  "type": "text"
                },
                {
                  "key": "client_id",
                  "value": "{{GraphClientIdReadBasic}}",
                  "type": "text"
                },
                {
                  "key": "client_secret",
                  "value": "{{GraphSecretReadBasic}}",
                  "type": "text"
                },
                {
                  "key": "resource",
                  "value": "{{loginResource}}",
                  "type": "text"
                }
              ]
            },
            "description": "Use refreshToken variable to request a new access token for the user in PPE environment."
          },
          "response": []
        },
        {
          "_postman_id": "4fc6c01b-3bf6-199b-610d-cc9f75bd91c9",
          "name": "Get Versions",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Status code is 200\"] = responseCode.code === 200;"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{host}}/versions",
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "{{GraphAuth}}",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "b7336210-fcda-9bfa-5bc1-4d20e9abfeff",
          "name": "Get Specific Version",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Status code is 200\"] = responseCode.code === 200;",
                  "tests[\"Rostering deployed\"] = responseBody.has('EducationRosteringAPIS');",
                  "if (responseBody.has('EducationRosteringAPIS'))",
                  "{",
                  "    var jsonData = JSON.parse(responseBody);",
                  "    postman.setEnvironmentVariable(\"rosteringVersion\", jsonData['Microsoft.EducationRosteringAPIS']);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{host}}/versions/{{graphVersion}}",
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "{{GraphAuth}}",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "description": ""
          },
          "response": []
        },
        {
          "_postman_id": "b99a5849-1807-73cc-a059-0a05b9f60a5c",
          "name": "Get Schema",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "tests[\"Status code is 200\"] = responseCode.code === 200;"
                ]
              }
            }
          ],
          "request": {
            "url": "http://{{host}}/schemas/Microsoft.EducationRosteringAPIS",
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "{{GraphAuth}}",
                "description": ""
              }
            ],
            "body": {
              "mode": "raw",
              "raw": ""
            },
            "description": ""
          },
          "response": []
        }
      ]
    },
    {
      "_postman_id": "cb778f16-5e1c-62de-8016-8959b8ef91b9",
      "name": "ReadWrite",
      "description": "",
      "item": []
    },
    {
      "_postman_id": "39bf9548-1c37-4f91-a8aa-16b4d70886a0",
      "name": "Initialize",
      "description": "",
      "item": []
    },
    {
      "_postman_id": "4b0cec2b-256f-01ec-01e2-901fa69be28d",
      "name": "T_RefreshToken GraphReadWrite",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Successful Request\"] = responseCode.code === 200;",
              "if(responseCode.code === 200)",
              "{",
              "    var data = JSON.parse(responseBody);",
              "    postman.setEnvironmentVariable(\"GraphAuth\", \"Bearer \" + data.access_token);",
              "    postman.setEnvironmentVariable(\"GraphRefresh\", data.refresh_token);",
              "    tests[\"New tokens written to environment\"] = true;",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "https://{{loginHost}}/common/oauth2/token",
        "method": "POST",
        "header": [],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "grant_type",
              "value": "refresh_token",
              "type": "text"
            },
            {
              "key": "refresh_token",
              "value": "{{GraphRefreshReadWrite}}",
              "type": "text"
            },
            {
              "key": "client_id",
              "value": "{{GraphClientIdReadWrite}}",
              "type": "text"
            },
            {
              "key": "client_secret",
              "value": "{{GraphSecretReadWrite}}",
              "type": "text"
            },
            {
              "key": "resource",
              "value": "{{loginResource}}",
              "type": "text"
            }
          ]
        },
        "description": "Use refreshToken variable to request a new access token for the user in PPE environment."
      },
      "response": []
    },
    {
      "_postman_id": "cbe8a664-6982-73cc-3a00-8053f13aa7ee",
      "name": "T_RefreshToken GraphRead",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Successful Request\"] = responseCode.code === 200;",
              "if(responseCode.code === 200)",
              "{",
              "    var data = JSON.parse(responseBody);",
              "    postman.setEnvironmentVariable(\"GraphAuth\", \"Bearer \" + data.access_token);",
              "    postman.setEnvironmentVariable(\"GraphRefresh\", data.refresh_token);",
              "    tests[\"New tokens written to environment\"] = true;",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "https://{{loginHost}}/common/oauth2/token",
        "method": "POST",
        "header": [],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "grant_type",
              "value": "refresh_token",
              "type": "text"
            },
            {
              "key": "refresh_token",
              "value": "{{GraphRefreshReadBasic}}",
              "type": "text"
            },
            {
              "key": "client_id",
              "value": "{{GraphClientIdReadBasic}}",
              "type": "text"
            },
            {
              "key": "client_secret",
              "value": "{{GraphSecretReadBasic}}",
              "type": "text"
            },
            {
              "key": "resource",
              "value": "{{loginResource}}",
              "type": "text"
            }
          ]
        },
        "description": "Use refreshToken variable to request a new access token for the user in PPE environment."
      },
      "response": []
    },
    {
      "_postman_id": "d379b2f4-c2f3-90c0-ef45-970906bbea7e",
      "name": "Get Rostering Schema",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Real Content\"]= responseBody.has('Namespace=\"Microsoft.Education.Rostering.Api\"');"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/schemas/Microsoft.EducationRosteringAPIS/{{rosteringVersion}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "a2488bb6-2c9a-a8c9-7c14-505421ece1a4",
      "name": "Get Education",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Expected fail\"] = responseCode.code === 400;"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e35dcb4a-76b3-3b07-87af-33f3737aa12f",
      "name": "Get Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools found\"] = responseBody.has('\"id\":')",
              "if (!responseBody.has('\"PrimaryTestSchool\"'))",
              "{",
              "    tests[\"School named PrimaryTestSchool required\"] = false;",
              "    postman.setNextRequest(null);",
              "}",
              "if (responseBody.has('\"id\":'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    var i;",
              "    for (i=0; i < jsonData.value.length; i++)",
              "    {",
              "        if (jsonData.value[i].displayName ===  'PrimaryTestSchool')",
              "        {",
              "            console.log(\"Primary test school id: \" + jsonData.value[i].id)",
              "            postman.setEnvironmentVariable(\"primaryTestSchoolId\", jsonData.value[i].id)",
              "        }",
              "    }",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "582310ac-0287-ca77-84ef-c53784025a42",
      "name": "Get Schools with Filter",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools found\"] = responseBody.has('\"id\":')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools?$filter=displayName eq 'PrimaryTestSchool'",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools"
          ],
          "query": [
            {
              "key": "$filter",
              "value": "displayName eq 'PrimaryTestSchool' ",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "08f89f90-6e35-384f-7717-c61c4b2e9964",
      "name": "Get Schools Expand Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes returned\"] = responseBody.has('classes\":[{'); ",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools?$expand=classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e5abe4c0-bbbe-a154-0828-70988156c24a",
      "name": "Get Schools Expand Users",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users returned\"] = responseBody.has('users\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools?$expand=users",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "users",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "730d1be6-5657-3ea6-61df-9673926927b8",
      "name": "Get Schools Expand Multi",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users and classes present\"] = responseBody.has('classes\":[{') && responseBody.has('users\":[{')  ;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools?$expand=users, classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "users, classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "51a56d88-c5a8-2153-4761-d85505bab0f1",
      "name": "Get A School",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{primaryTestSchoolId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "2dffec50-6621-c8ad-9dd3-aaecf23165ca",
      "name": "Get A School Expand Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes returned\"] = responseBody.has('classes\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools/{{primaryTestSchoolId}}?$expand=classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools",
            "{{primaryTestSchoolId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "2d56930b-1804-b3f2-c0d2-beae627bec84",
      "name": "Get A School Expand Users",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users returned\"] = responseBody.has('users\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools/{{primaryTestSchoolId}}?$expand=users",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools",
            "{{primaryTestSchoolId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "users",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "4d63bd3c-d45d-003e-f476-53d93ba4cff0",
      "name": "Get A School Expand Multi",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users and classes present\"] = responseBody.has('classes\":[{') && responseBody.has('users\":[{');"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/schools/{{primaryTestSchoolId}}?$expand=users,classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "schools",
            "{{primaryTestSchoolId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "users,classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "fae8ff66-e3dc-4a51-4633-cd15b2b780ea",
      "name": "Get A School Nav Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{primaryTestSchoolId}}/classes",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "794c1812-6d80-af44-5a5f-779886efbf5c",
      "name": "Get A School Nav Users",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{primaryTestSchoolId}}/users",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "3f90c359-1e10-8752-22ba-7135733fdf6d",
      "name": "Get Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes found\"] = responseBody.has('\"id\":')",
              "if (!responseBody.has('\"PrimaryTestClass\"'))",
              "{",
              "    tests[\"Class named PrimaryTestClass required\"] = false;",
              "    postman.setNextRequest(null);",
              "}",
              "",
              "if (responseBody.has('\"id\":'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    var i;",
              "    for (i=0; i < jsonData.value.length; i++)",
              "    {",
              "        if (jsonData.value[i].displayName ===  'PrimaryTestClass')",
              "        {",
              "            console.log(\"Primary test class id: \" + jsonData.value[i].id)",
              "            postman.setEnvironmentVariable(\"primaryTestClassId\", jsonData.value[i].id)",
              "        }",
              "    }",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "70fbdfe0-90d1-bafa-fd84-260188936a5d",
      "name": "Get Classes with Filter",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes found\"] = responseBody.has('\"id\":')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes?filter=displayName eq 'PrimaryTestClass' and mailNickname eq 'PrimaryTestClass'",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes"
          ],
          "query": [
            {
              "key": "filter",
              "value": "displayName eq 'PrimaryTestClass' and mailNickname eq 'PrimaryTestClass'",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "f888e07b-b3f5-099d-14d3-93e5996e2f87",
      "name": "Get Classes Expand Members",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Members returned\"] = responseBody.has('members\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes?$expand=members",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "members",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "f3d4f69a-887c-e71c-7c1e-f0cae02485b5",
      "name": "Get Classes Expand Teachers",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Teachers returned\"] = responseBody.has('teachers\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes?$expand=teachers",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "teachers",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "6a562d70-cc4c-acc9-6e66-7ef0af9a8151",
      "name": "Get Classes Expand Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools returned\"] = responseBody.has('schools\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes?$expand=schools",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "schools",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "52254573-366b-0e16-d033-95dc101b1c26",
      "name": "Get A Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "60e71461-6027-8cea-1571-69722e9736c8",
      "name": "Get A Class Expand Members",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Members returned\"] = responseBody.has('members\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}?$expand=members",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes",
            "{{primaryTestClassId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "members",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "f0e13c75-5e45-8b95-aaf4-ba1e1c59e0bd",
      "name": "Get A Class Expand Teachers",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Teachers returned\"] = responseBody.has('teachers\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}?$expand=teachers",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes",
            "{{primaryTestClassId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "teachers",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "c0f3f6a8-bcff-9cc9-3cf9-9d7f5100adcc",
      "name": "Get A Class Expand Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools returned\"] = responseBody.has('schools\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}?$expand=schools",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "classes",
            "{{primaryTestClassId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "schools",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "48daba02-7c40-1213-33a2-1320934b497e",
      "name": "Get A Class Nav Members",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Members returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}/members",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "c0cc281d-93cd-c8f4-71b9-b3e402952e79",
      "name": "Get A Class Nav Teachers",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Teachers returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}/teachers",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e9e0dcc1-b686-935b-5c45-381d2472c73b",
      "name": "Get A Class Nav Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}/schools",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "7c69230e-3f8e-1108-09a7-9105c709a1d6",
      "name": "FIND A non-education Group",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"noneducationgroup found\"] = responseBody.has(\"noneducationgroup\");",
              "if (responseBody.has('noneducationgroup'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    var i;",
              "    for (i=0; i < jsonData.value.length; i++)",
              "    {",
              "        if (jsonData.value[i].displayName ===  'noneducationgroup')",
              "        {",
              "            console.log(\"noneducationgroup id: \" + jsonData.value[i].id)",
              "            postman.setEnvironmentVariable(\"nonEducationGroupId\", jsonData.value[i].id)",
              "        }",
              "    }",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/groups?$filter=displayName eq 'noneducationgroup'",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "groups"
          ],
          "query": [
            {
              "key": "$filter",
              "value": "displayName eq 'noneducationgroup'",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \"@odata.type\":\"microsoft.graph.group\",\n   \"displayName\":\"GarethClass28\",\n   \"mailNickname\":\"class282\",\n   \"mailEnabled\":true,\n   \"securityEnabled\":false,\n   \"extension_fe2174665583431c953114ff7268b7b3_Education_Period\":\"5\",\n   \"groupTypes\":[\"Unified\"]}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "b03d6606-b80d-6483-bd98-fe374c8997ae",
      "name": "GET A non-education Group as Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 404\"] = responseCode.code === 404;",
              "tests[\"Good error\"] = responseBody.has(\"Resource not found\");"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{nonEducationGroupId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \"@odata.type\":\"microsoft.graph.group\",\n   \"displayName\":\"GarethClass28\",\n   \"mailNickname\":\"class282\",\n   \"mailEnabled\":true,\n   \"securityEnabled\":false,\n   \"extension_fe2174665583431c953114ff7268b7b3_Education_Period\":\"5\",\n   \"groupTypes\":[\"Unified\"]}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "83edf54d-d981-ebe1-32d1-1af57a24d74e",
      "name": "Fail to GET Vanilla Groups",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 403\"] = responseCode.code === 403;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/groups",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \"@odata.type\":\"microsoft.graph.group\",\n   \"displayName\":\"GarethClass28\",\n   \"mailNickname\":\"class282\",\n   \"mailEnabled\":true,\n   \"securityEnabled\":false,\n   \"extension_fe2174665583431c953114ff7268b7b3_Education_Period\":\"5\",\n   \"groupTypes\":[\"Unified\"]}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "139f0c96-13cb-aa99-ec6c-bc963b89a064",
      "name": "Get Users",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users found\"] = responseBody.has('\"id\":')",
              "if (!responseBody.has('\"PrimaryTestUser\"'))",
              "{",
              "    tests[\"User named PrimaryTestUser required\"] = false;",
              "    postman.setNextRequest(null);",
              "}",
              "",
              "if (responseBody.has('\"id\":'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    var i;",
              "    for (i=0; i < jsonData.value.length; i++)",
              "    {",
              "        if (jsonData.value[i].displayName === 'PrimaryTestUser')",
              "        {",
              "            console.log(\"Primary test user id: \" + jsonData.value[i].id)",
              "            postman.setEnvironmentVariable(\"primaryTestUserId\", jsonData.value[i].id)",
              "        }",
              "    }",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "fa5be57e-7360-1c3d-8c3b-17fd4f60ae7b",
      "name": "Get Users with Filter",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Users found\"] = responseBody.has('\"id\":')",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users?$filter=displayName eq 'PrimaryTestUser'",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users"
          ],
          "query": [
            {
              "key": "$filter",
              "value": "displayName eq 'PrimaryTestUser'",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "0ee50d55-1d78-d393-6365-b8d4e7f8748f",
      "name": "Get Users Expand Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools returned\"] = responseBody.has('schools\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users?$expand=schools",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "schools",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "96623da2-cd16-99e2-d29b-4a7e458ece38",
      "name": "Get Users Expand Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes returned\"] = responseBody.has('classes\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users?$expand=classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "3680319a-3373-653a-0f29-f955af1b70e9",
      "name": "Get Users Expand Multi",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools and classes present\"] = responseBody.has('classes\":[{') && responseBody.has('schools\":[{')  ;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users?$expand=classes,schools",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "classes,schools",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "65faab0f-9105-9f30-c74a-69daab1b53ca",
      "name": "Get A User",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"User found\"] = responseBody.has('\"id\":')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "17796906-21ee-91a3-1bfe-815d863cea43",
      "name": "Get A User  Expand Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools returned\"] = responseBody.has('schools\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}?$expand=schools",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users",
            "{{primaryTestUserId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "schools",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "2f63c999-5fbd-015c-9635-1001f3087508",
      "name": "Get A User  Expand Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes returned\"] = responseBody.has('classes\":[{'); "
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}?$expand=classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users",
            "{{primaryTestUserId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "cc630710-2851-77f9-6b39-2df500546845",
      "name": "Get A User  Expand Multi",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools and classes present\"] = responseBody.has('classes\":[{') && responseBody.has('schools\":[{')  ;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}?$expand=schools,classes",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "education",
            "users",
            "{{primaryTestUserId}}"
          ],
          "query": [
            {
              "key": "$expand",
              "value": "schools,classes",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "1d84b419-4f05-4946-b620-a93b31c9dd79",
      "name": "Get A User  Nav Schools",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Schools returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}/schools",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "8b84616e-b861-4859-c668-289d2f27ec65",
      "name": "Get A User  Nav Classes",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Classes returned\"] = responseBody.has('value\":[{')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}/classes",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "cb2c6c33-3aae-2ab4-4303-3ba68c5266df",
      "name": "FIND A non-education User",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"noneducationuser found\"] = responseBody.has(\"SchoolAdministrator\");",
              "if (responseBody.has('SchoolAdministrator'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    var i;",
              "    for (i=0; i < jsonData.value.length; i++)",
              "    {",
              "        if (jsonData.value[i].displayName ===  'SchoolAdministrator')",
              "        {",
              "            console.log(\"noneducationuser id: \" + jsonData.value[i].id)",
              "            postman.setEnvironmentVariable(\"nonEducationUserId\", jsonData.value[i].id)",
              "        }",
              "    }",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": {
          "raw": "http://{{host}}/{{graphVersion}}/users?$filter=displayName eq 'SchoolAdministrator'",
          "protocol": "http",
          "auth": {},
          "host": [
            "{{host}}"
          ],
          "path": [
            "{{graphVersion}}",
            "users"
          ],
          "query": [
            {
              "key": "$filter",
              "value": "displayName eq 'SchoolAdministrator'",
              "equals": true,
              "description": ""
            }
          ],
          "variable": []
        },
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \"@odata.type\":\"microsoft.graph.group\",\n   \"displayName\":\"GarethClass28\",\n   \"mailNickname\":\"class282\",\n   \"mailEnabled\":true,\n   \"securityEnabled\":false,\n   \"extension_fe2174665583431c953114ff7268b7b3_Education_Period\":\"5\",\n   \"groupTypes\":[\"Unified\"]}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "d705f00c-e395-5674-dc8b-567b95fd781e",
      "name": "GET Non-education User as EduUser",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 404\"] = responseCode.code === 404;",
              "tests[\"Good error\"] = responseBody.has(\"Resource not found\");"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{nonEducationUserId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \"@odata.type\":\"microsoft.graph.group\",\n   \"displayName\":\"GarethClass28\",\n   \"mailNickname\":\"class282\",\n   \"mailEnabled\":true,\n   \"securityEnabled\":false,\n   \"extension_fe2174665583431c953114ff7268b7b3_Education_Period\":\"5\",\n   \"groupTypes\":[\"Unified\"]}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "0b831e58-63ad-8ac3-5895-5fb26922101d",
      "name": "Fail to Get Vanilla Users",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 403\"] = responseCode.code === 403;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/users",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"tags\": \"IncludeEntityAbstractBaseType;DeltaSyncSupported;EnableNoDollarSystemQueryParameters\",\n    \"Microsoft.DirectoryServices\": \"Beta20170306\",\n    \"Microsoft.EducationRosteringAPIS\": \"20170313.3\",\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "80d42fda-4d74-0152-4e09-5d59607673be",
      "name": "Get EDU me",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"User found\"] = responseBody.has('\"id\":')"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/me",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {},
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e3d7c87e-c374-f8f0-792e-96eb41cd8a77",
      "name": "Make a School",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 201\"] = responseCode.code === 201;",
              "tests[\"School created\"] = responseBody.has('\"id\":')",
              "if (responseBody.has('\"id\":'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    postman.setEnvironmentVariable(\"justCreatedId\", jsonData.id)",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}",
              "var currentRandom = Math.floor(Math.random() * 1000).toString();",
              "var currentRandom2 = Math.floor(Math.random() * 1000).toString();",
              "postman.setEnvironmentVariable(\"currentRandom\", currentRandom + currentRandom2);"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationSchool\",\n\t\"displayName\":\"SchoolTestRun{{currentRandom}}\",\n\t\"description\": \"A lovely school to test.\",\n\t\"externalSource\": \"SIS\",\n\t\"address\": {\n\t    \"street\": \"1 Bash Street\",\n\t    \"city\": \"Redmond\",\n\t    \"state\": \"WA\",\n\t    \"countryOrRegion\": \"USA\",\n\t    \"postalCode\": \"98052\"\n \t}\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "080bb4b8-7d4d-131e-4487-36230f557605",
      "name": "Add a School Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/classes/$ref",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \n\t\"@odata.id\":\"https://{{host}}/{{graphVersion}}/education/classes/{{primaryTestClassId}}\" \n}\n"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e3007354-8d13-787a-eb48-c50971f17302",
      "name": "Add a School User",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              "postman.setEnvironmentVariable(\"retryCount\", \"0\");",
              "GlobalFunctions.delayBefore(\"Check just added Class\", postman);",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/users/$ref",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \n\t\"@odata.id\":\"https://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}\" \n}\n"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "dd21d570-2646-f67f-d9c3-6dc5bc3b5b12",
      "name": "Check just created School",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"School created\"] = responseBody.has('\"id\":')",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "f5a20ee4-ccb5-e33e-03fa-b16f1404ac9c",
      "name": "Check just added Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200 - iteration: \" + postman.getEnvironmentVariable(\"retryCount\")] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    if (jsonData.value.length === 1)",
              "    {",
              "        tests[\"One Class\"] = true;",
              "        tests[\"Class added\"] = jsonData.value.length === 1 && jsonData.value[0].id === postman.getEnvironmentVariable(\"primaryTestClassId\");",
              "        postman.setEnvironmentVariable(\"retryCount\", \"0\");",
              "    }",
              "    else",
              "    {   ",
              "        GlobalFunctions.retryTest(\"Check just added Class\", \"One Class\", postman, tests);",
              "    }",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/classes",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e42f50b8-d6ed-bdbd-a6f7-8ee2a15257eb",
      "name": "Check just added User",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"One User\"] = jsonData.value.length === 1;",
              "    tests[\"User added\"] = jsonData.value.length === 1 && jsonData.value[0].id === postman.getEnvironmentVariable(\"primaryTestUserId\");",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/users",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "5577ce60-62bb-eb3a-923e-604b2c74f513",
      "name": "Delete School Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/classes/{{primaryTestClassId}}/$ref",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e2e531a8-7fb2-22d7-17f0-59054cf5a6ae",
      "name": "Delete School User",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              "postman.setEnvironmentVariable(\"retryCount\", \"0\");",
              "GlobalFunctions.delayBefore(\"Check Class removed\", postman);"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/users/{{primaryTestUserId}}/$ref",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "3a32b29a-8287-5fa0-e600-584a9cb6cbf8",
      "name": "Check Class removed",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200 - iteration: \" + postman.getEnvironmentVariable(\"retryCount\")] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    if (jsonData.value.length === 0)",
              "    {",
              "        tests[\"Class removed\"] = true;",
              "        postman.setEnvironmentVariable(\"retryCount\", \"0\");",
              "    }",
              "    else",
              "    {",
              "        GlobalFunctions.retryTest(\"Check Class removed\", \"Class removed\", postman, tests);",
              "    }",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/classes",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "ccb8fce5-6cdf-12ca-2e07-79d08bc6ab43",
      "name": "Check User removed",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"User removed\"] = jsonData.value.length === 0;",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}/users",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "b667e35d-36f1-c678-8b39-2eee35409b44",
      "name": "Modify just created School",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}",
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"description\": \"An even better school to test.\",\n\t\"externalSource\": \"Manual\",\n\t\"address\": {\n\t    \"city\": \"Seattle\"\n \t}\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "c94b7d76-2fb6-6816-e175-29cf5239c284",
      "name": "Check modification to School",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"School present\"] = responseBody.has('\"id\":')",
              "tests[\"Simple data modified\"] = responseBody.has('\"description\":\"An even better school to test.\"');",
              "tests[\"Custom data modified\"] = responseBody.has('\"externalSource\":\"Manual\"');",
              "tests[\"Custom school data modified\"] = responseBody.has('\"city\":\"Seattle\"');",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "dd4d9136-87e5-ddb3-f622-81a7357dbcc8",
      "name": "Delete just created School",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "beba8fa8-7782-eacb-9794-2ca6170fac8c",
      "name": "Check School deleted",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 404\"] = responseCode.code === 404;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/schools/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "6529be0b-a536-b36c-96cf-92693d2bd4e3",
      "name": "Make a Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 201\"] = responseCode.code === 201;",
              "tests[\"Class created\"] = responseBody.has('\"id\":')",
              "if (responseBody.has('\"id\":'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    postman.setEnvironmentVariable(\"justCreatedId\", jsonData.id)",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}",
              "var currentRandom = Math.floor(Math.random() * 1000).toString();",
              "var currentRandom2 = Math.floor(Math.random() * 1000).toString();",
              "postman.setEnvironmentVariable(\"currentRandom\", currentRandom + currentRandom2);"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"ClassTestRun{{currentRandom}}\",\n\t\"mailNickname\":\"classtest{{currentRandom}}\",\n\t\"period\":\"5\",\n\t\"externalSource\": \"SIS\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "6fa6c157-f2ce-85de-9697-3958b6c73a36",
      "name": "Check just created Class retrievable",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Class created\"] = responseBody.has('\"id\":')",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "835de137-0f3d-ff8b-b3e5-d82c7a89c528",
      "name": "Add a Class member",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/members/$ref",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \n\t\"@odata.id\":\"https://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}\" \n}\n"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "8b864107-aa30-e834-4c4d-9460beca776c",
      "name": "Add a Class teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/teachers/$ref",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{  \n\t\"@odata.id\":\"https://{{host}}/{{graphVersion}}/education/users/{{primaryTestUserId}}\" \n}\n"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "55f27f6a-050a-e6d3-1d02-5bf6a7c3cdfb",
      "name": "Check just added member",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"One Member\"] = jsonData.value.length === 1;",
              "    tests[\"Member added\"] = jsonData.value.length === 1 && jsonData.value[0].id === postman.getEnvironmentVariable(\"primaryTestUserId\");",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/members",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "0224cd35-8967-ceea-a5bb-67d05c46072d",
      "name": "Check just added teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"One Teacher\"] = jsonData.value.length === 1;",
              "    tests[\"Teacher added\"] = jsonData.value.length === 1 && jsonData.value[0].id === postman.getEnvironmentVariable(\"primaryTestUserId\");",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/teachers",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "3171ecaa-9cb7-b598-004d-143fb444b0d4",
      "name": "Delete Class member",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/members/{{primaryTestUserId}}/$ref",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "121d4760-908f-6641-fb6d-c9c9350b8df7",
      "name": "Delete Class teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/teachers/{{primaryTestUserId}}/$ref",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "4014dd06-a7bf-a3a6-c154-d98106e3c37c",
      "name": "Check member removed",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"Member removed\"] = jsonData.value.length === 0;",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/members",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "36bd737d-1ed2-2211-e1f4-c38d56610fe0",
      "name": "Check teacher removed",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "if ( responseCode.code === 200)",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"Teacher removed\"] = jsonData.value.length === 0;",
              "}",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}/teachers",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "8ab383ab-6436-865b-5aa0-dd2abc309ed3",
      "name": "Modify just created Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}",
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"period\": \"7\",\n\t\"displayName\": \"ChangedClass\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "8d159354-a371-7710-fc28-8969b0a2ed69",
      "name": "Check modification to Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"Class present\"] = responseBody.has('\"id\":');",
              "tests[\"Custom data modified\"] = responseBody.has('\"period\":\"7\"');",
              "tests[\"Standard data modified\"] = responseBody.has('\"displayName\":\"ChangedClass\"');"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "b2b5f9fc-cee4-c593-53d5-9e27e63c286b",
      "name": "Delete just created Class",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "08f6409a-04a4-d242-9982-026c6231dcea",
      "name": "Check Class deleted",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 404\"] = responseCode.code === 404;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/classes/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "427f7e99-41bc-d499-0382-75b49a01bf0c",
      "name": "Make a Teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 201\"] = responseCode.code === 201;",
              "tests[\"User created\"] = responseBody.has('\"id\":')",
              "if (responseBody.has('\"id\":'))",
              "{",
              "    var jsonData = JSON.parse(responseBody);",
              "    tests[\"Role set\"] = jsonData.primaryRole === 'teacher';",
              "    tests[\"TeacherNumber set\"] = jsonData.teacher.teacherNumber === '456';",
              "    postman.setEnvironmentVariable(\"justCreatedId\", jsonData.id)",
              "}"
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}",
              "var currentRandom = Math.floor(Math.random() * 1000).toString();",
              "var currentRandom2 = Math.floor(Math.random() * 1000).toString();",
              "postman.setEnvironmentVariable(\"currentRandom\", currentRandom + currentRandom2);"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users",
        "method": "POST",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationUser\",\n\t\"accountEnabled\": true,\n\t\"displayName\":\"Teacher TestRun{{currentRandom}}\",\n\t\"mailNickname\": \"TeacherTR{{currentRandom}}\",\n\t\"userPrincipalName\": \"TeacherTR{{currentRandom}}@{{tenantDomain}}\",\n\t\"middleName\": \"Middle\",\n\t\"passwordProfile\":{\n\t\t\"forceChangePasswordNextSignIn\": false,\n\t\t\"password\": \"!!abc123\"\n\t},\n\t\"primaryRole\": \"Teacher\",\n\t\"teacher\": {\n\t\t\"teacherNumber\": \"456\",\n\t\t\"externalId\": \"123\"\n\t}\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "b286f6f3-4112-b2b3-7988-dd4573daf9e5",
      "name": "Check just created Teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"User created\"] = responseBody.has('\"id\":')",
              "tests[\"Custom data created\"] = responseBody.has('\"Middle\"')",
              "tests[\"Custom teacher data created\"] = responseBody.has('\"teacherNumber\":\"456\"')",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "65c8397a-2e61-9f08-3bc3-24487d48669a",
      "name": "Modify just created Teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{justCreatedId}}",
        "method": "PATCH",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"displayName\": \"Reacher TestRun\",\n\t\"middleName\": \"Hann\",\n\t\"teacher\": {\n\t\t\"teacherNumber\": \"102\"\n\t  }\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e9dd711f-5c09-c582-c936-d124046122ae",
      "name": "Check modification to Teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 200\"] = responseCode.code === 200;",
              "tests[\"User present\"] = responseBody.has('\"id\":')",
              "tests[\"Simple data modified\"] = responseBody.has('\"displayName\":\"Reacher TestRun\"');",
              "tests[\"Custom data modified\"] = responseBody.has('\"Hann\"')",
              "tests[\"Custom teacher data modified\"] = responseBody.has('\"teacherNumber\":\"102\"')",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "de0c35e6-55b0-1738-fecb-9f6a7c5a2dc0",
      "name": "Delete just created Teacher",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 204\"] = responseCode.code === 204;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{justCreatedId}}",
        "method": "DELETE",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "17b07fd1-ff78-4898-b09a-b4ff5f448f21",
      "name": "Check Teacher deleted",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "tests[\"Status code is 404\"] = responseCode.code === 404;",
              ""
            ]
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "if (this.hasOwnProperty(\"GlobalFunctions\") )",
              "{",
              "    GlobalFunctions.setupMetadataLevel(iteration, postman);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/education/users/{{justCreatedId}}",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          },
          {
            "key": "Workload-Authorization",
            "value": "{{AADAuth}}",
            "description": "",
            "disabled": true
          },
          {
            "key": "Accept",
            "value": "application/json;odata.metadata={{MetadataLevel}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n\t\"@odata.type\": \"microsoft.graph.educationClass\",\n\t\"displayName\":\"GarethClassTestRun60\",\n\t\"mailNickname\":\"classtest60\",\n\t\"period\":\"5\"\n}"
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "02693be3-c74c-be8a-3f94-b86ca8411dfe",
      "name": "FINAL TEST",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// The Sole purpose of this FINAL TEST is to reset the environment variable Metadata level to minimal",
              "// Keep it as the last test in any run.",
              "postman.setEnvironmentVariable(\"MetadataLevel\", \"minimal\");",
              "postman.setNextRequest(null);",
              ""
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/$metadata",
        "method": "GET",
        "header": [
          {
            "key": "Authorization",
            "value": "{{GraphAuth}}",
            "description": ""
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "description": ""
      },
      "response": []
    },
    {
      "_postman_id": "e8b4a8d3-74da-ef72-9a64-5801e676e7d1",
      "name": "Delay",
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "postman.setNextRequest(postman.getEnvironmentVariable(\"returnRequest\"));"
            ]
          }
        }
      ],
      "request": {
        "url": "https://echo.getpostman.com/delay/10",
        "method": "GET",
        "header": [],
        "body": {},
        "description": "Using this endpoint one can configure how long it takes for the server to come back with a response. Appending a number to the URL defines the time (in seconds) the server will wait before responding.\n\nNote that a maximum delay of 10 seconds is accepted by the server."
      },
      "response": []
    },
    {
      "_postman_id": "cf78f9a7-42d2-ca78-ff82-b3a66a1428fb",
      "name": "T_InitializeScripts",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "postman.setEnvironmentVariable(\"retryCount\", \"0\");\r",
              "postman.setEnvironmentVariable(\"retryDelay\", \"3\");\r",
              "GlobalFunctions = {\r",
              "setupMetadataLevel: function(iteration, postman) {\r",
              "    if (iteration % 3 === 0)\r",
              "    {\r",
              "      postman.setEnvironmentVariable(\"MetadataLevel\", \"none\");\r",
              "      console.log(\"Metadata = none\");\r",
              "    }\r",
              "    else if ( iteration % 3 === 1)\r",
              "    {\r",
              "      postman.setEnvironmentVariable(\"MetadataLevel\", \"minimal\");\r",
              "      console.log(\"Metadata = minimal\");\r",
              "    }\r",
              "    else if ( iteration % 3 === 2)\r",
              "    {\r",
              "      postman.setEnvironmentVariable(\"MetadataLevel\", \"full\");\r",
              "      console.log(\"Metadata = full\");\r",
              "    }\r",
              "},\r",
              "retryTest: function(requestName, testName, postman, tests) {\r",
              "    var retryString = postman.getEnvironmentVariable(\"retryCount\");\r",
              "    if (retryString === null || retryString === \"\")\r",
              "    {\r",
              "        retryString = \"0\";\r",
              "    }\r",
              "    var retryCount = parseInt(retryString);\r",
              "    retryCount++;\r",
              "    postman.setEnvironmentVariable(\"retryCount\", retryCount);\r",
              "    if (retryCount < 16)\r",
              "    {\r",
              "        postman.setEnvironmentVariable(\"returnRequest\", requestName);\r",
              "        postman.setNextRequest(\"Delay\");\r",
              "        console.log(\"iteration \" + retryCount);\r",
              "    }\r",
              "    else\r",
              "    {\r",
              "        postman.setEnvironmentVariable(\"retryCount\", \"0\");\r",
              "        tests[testName] = false;\r",
              "    }\r",
              "},\r",
              "delayBefore: function(requestName, postman) {\r",
              "    postman.setEnvironmentVariable(\"returnRequest\", requestName);\r",
              "    postman.setNextRequest(\"Delay\");\r",
              "}\r",
              "}"
            ]
          }
        }
      ],
      "request": {
        "url": "http://{{host}}/{{graphVersion}}/$metadata",
        "method": "GET",
        "header": [],
        "body": {},
        "description": "Use refreshToken variable to request a new access token for the user in PPE environment."
      },
      "response": []
    }
  ]
}